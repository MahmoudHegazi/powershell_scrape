#setup
$WSH = New-Object -Com WScript.Shell;Add-Type -MemberDefinition '[DllImport("user32.dll")] public static extern void mouse_event(int flags, int dx, int dy, int cButtons, int info);' -Name U32 -Namespace W;Add-Type -AssemblyName System.Windows.Forms;$screen = [System.Windows.Forms.SystemInformation]::VirtualScreen;$screen = [System.Windows.Forms.SystemInformation]::VirtualScreen;
# scrape any browser or with js and forms and redirect JSHuman Teseter
start chrome 'http://localhost:5000/premium_sync';$WSH.AppActivate("chrome");start-sleep -S 2;start-sleep -S 1;$WSH.AppActivate("chrome");start-sleep -S 1;$WSH.SendKeys("{F12}");[Windows.Forms.Cursor]::Position = "$($screen.Width - 100),$($screen.Height - $screen.Height / 2)";start-sleep -S 2;[W.U32]::mouse_event(6,0,0,0,0);start-sleep -S 2;$WSH.SendKeys("document.querySelector{(}{'}form input{'}{)}{.}click{(}{)}{;}console.clear{(}{)}{;}~");start-sleep -S 2;$WSH.SendKeys("target_file.xlsx~");start-sleep -S 2;$WSH.AppActivate("chrome");start-sleep -S 2;[Windows.Forms.Cursor]::Position = "$($screen.Width - 100),$($screen.Height - $screen.Height / 2)";start-sleep -S 1;[W.U32]::mouse_event(6,0,0,0,0);start-sleep -S 1;$WSH.SendKeys("document.querySelectorAll{(}{'}form input{'}{)}{[}1{]}{.}click{(}{)}{;}console.clear{(}{)}{;}~");start-sleep -S 10;$WSH.SendKeys("document.querySelector{(}{'}#load_file{'}{)}{.}click{(}{)}{;}console.clear{(}{)}{;}~");

